@using MrCMS.Helpers
@model MrCMS.Entities.Documents.Web.Webpage
<div style="position: fixed; top: 0; width: 100%">
    <iframe src="/Admin/InPageAdmin/InPageEditorPage/@Model.Id" height="40" width="100%" frameborder="0" ></iframe>
</div>

<link href="@Url.Content("~/Areas/Admin/Content/Styles/front-end-editing.css")" rel="stylesheet" type="text/css" />
<link href="@Url.Content("~/Areas/Admin/Content/Editors/fancybox/jquery.fancybox-1.3.4.css")" rel="stylesheet" type="text/css" />
   
<script src="@Url.Content("~/Areas/Admin/Content/Editors/ckeditor/ckeditor.js")"> </script>
<script src="@Url.Content("~/Areas/Admin/Content/Scripts/jquery.mrcms-mediaselector.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Areas/Admin/Content/Editors/fancybox/jquery.easing-1.3.pack.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Areas/Admin/Content/Editors/fancybox/jquery.mousewheel-3.0.4.pack.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Areas/Admin/Content/Editors/fancybox/jquery.fancybox-1.3.4.pack.js")"></script>

<script>
    $(document).on('click', '[data-toggle="fb-modal"]', function () {
        var clone = $(this).clone();
        clone.attr('data-toggle', '');
        clone.hide();
        clone.fancybox({
            type: 'iframe',
            padding: 0,
            height: 0,
            'onComplete': function () {
                $('#fancybox-frame').load(function () { // wait for frame to load and then gets it's height
                    $(this).contents().find('form').attr('target', '_parent').css('margin', '0');
                    var additionalHeight = 0;
                    var ckeditor = $("#fancybox-frame").contents().find('.ckedit-enabled');
                    if (ckeditor.length > 0) {
                        additionalHeight = 300;
                    }
                    var height = $("#fancybox-frame").contents().find('html').height() + additionalHeight;
                    if (height > $(top.window).height())
                        height = $(top.window).height() - 100;
                    var documentWidth = $('html').width() - 200;
                    if (documentWidth > 1000)
                        documentWidth = 1000;
                    var width = (documentWidth);

                    $('#fancybox-content, #fancybox-wrap, #fancybox-frame').height(height);
                    $('#fancybox-content, #fancybox-wrap, #fancybox-frame').width(width);
                    $.fancybox.center();
                });
            }
        }).click().remove();
        return false;
    });
</script>