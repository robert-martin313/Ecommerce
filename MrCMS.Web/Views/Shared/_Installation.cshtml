@using MrCMS.Apps
@using MrCMS.Helpers
@using MrCMS.Website
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Mr CMS installation</title>
    <link href="~/Areas/Admin/Content/Styles/bootstrap/css/bootstrap.css" rel="stylesheet" />
    <link href="@Url.Content("~/Content/Install/style.css")" type="text/css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <img src="~/Areas/Admin/Content/Images/logo.png" class="margin-top-10" /> <br /><p class="margin-top-10">
    To complete this wizard you must know some information regarding your database server
    ("connection string"). Please contact your ISP if necessary. If you're installing
    on a local machine or server you might need information from your System Admin.
</p>
            </div>
        </div>
        <br />
        @RenderBody()

        <footer>
            <hr />
            <p class="display-inline">
                &copy; Mr CMS 2012-@CurrentRequestData.Now.Year - v@(Html.AssemblyVersion()) - Installed apps: @MrCMSApp.CurrentAppSummary
                <span class="pull-right" style="margin-right: 20px;">Logged in from @CurrentRequestData.CurrentContext.GetCurrentIP()</span>
            </p>
        </footer>

        <div id="throbber">
            <div class="curtain">
            </div>
            <div class="curtain-content">
                <div>
                    <h1 id="setUpHeader">Installing Mr CMS...</h1>
                    <p>
                        <img src="@Url.Content("~/content/install/images/install-synchronizing.gif")" alt="" />
                    </p>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <script src="@Url.Content("~/Content/install/scripts/jquery.validate.js")" type="text/javascript"> </script>
    <script src="@Url.Content("~/Content/install/scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"> </script>

    <script type="text/javascript">
        $(document).ready(function () {

        });

        $(document).ready(function () {
            $('input:radio[name=DatabaseType]').click(toggleProvider);
            $('input:radio[name=SqlConnectionInfo]').click(toggleSqlConnectionInfo);
            $('input:radio[name=SqlAuthenticationType]').click(toggleSqlAuthenticationType);

            toggleProvider();
            toggleSqlConnectionInfo();
            toggleSqlAuthenticationType();
        });


        function toggleProvider() {
            var selectedProvider = $("input[name=DatabaseType]:checked").attr('id');
            if (selectedProvider == 'provider_sqlite') {
                $('#sqlConnectionInfo').hide();
            } else {
                $('#sqlConnectionInfo').show();
            }
        }

        function toggleSqlConnectionInfo() {
            var selectedProvider = $("input[name=SqlConnectionInfo]:checked").attr('id');
            if (selectedProvider == 'sqlconnectioninfo_values') {
                $('#sqlDatabaseInfo').show();
                $('#sqlDatabaseConnectionString').hide();
            } else if (selectedProvider == 'sqlconnectioninfo_raw') {
                $('#sqlDatabaseInfo').hide();
                $('#sqlDatabaseConnectionString').show();
            }
        }

        function toggleSqlAuthenticationType() {
            var selectedProvider = $("input[name=SqlAuthenticationType]:checked").attr('id');
            if (selectedProvider == 'sqlauthenticationtype_sql') {
                $('#pnlSqlServerUsername').show();
                $('#pnlSqlServerPassword').show();
            } else if (selectedProvider == 'sqlauthenticationtype_windows') {
                $('#pnlSqlServerUsername').hide();
                $('#pnlSqlServerPassword').hide();
            }
        }


        (function () {

            function show() {
                window.setTimeout(function () {
                    document.getElementById("throbber").style.display = "block";
                }, 1000);
            }

            if (document.addEventListener) {
                document.addEventListener("submit", show, false);
            } else {
                document.forms[0].attachEvent("onsubmit", show);
            }
        })();

    </script>
</body>
</html>
