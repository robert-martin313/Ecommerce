@using MrCMS.Helpers
@model MrCMS.Paging.IPagedList<MrCMS.Web.Apps.Ecommerce.Entities.Products.ProductVariant>
@{
    ViewBag.Title = "Low Stock Report";
}

<fieldset>
    <legend>Low Stock Report
        <span class="btn-group  display-inline  pull-right">
            @using (Html.BeginForm("ExportLowStockReport", "Stock", new { treshold = ViewData["treshold"] }, FormMethod.Post, new { style = "margin:0" }))
            {
                <input type="submit" class="btn btn-primary" value="Export Low Stock Report (CSV)" />
            }
        </span>
    </legend>
    @if(!String.IsNullOrWhiteSpace(ViewBag.Status))
    {
        <br />
        <span class="alert alert-info">@ViewBag.Status</span>
        <div class="clearfix"></div>
        <hr/>
    }
    <div class="row-fluid">
    @using (Html.BeginForm("LowStockReport", "Stock", FormMethod.Get))
    {
        <input type="text" class="search-query input-mini" placeholder="Treshold" id="treshold" name="t" value="@ViewData["treshold"]" />
        <input type="submit" class="btn btn-primary btn-success" value="Generate Report" />
    }
    </div>
    <hr />
    @if (Model.Count == 0)
    {
        @:No products with low stock.
    }
    else
    {
         <div class="row-fluid">
        <div class="span3">
            <strong>Name</strong>
        </div>
        <div class="span2">
           <strong>SKU</strong>
        </div>
        <div class="span1">
            <strong>Price</strong>
        </div>
        <div class="span2">
            <strong>Published</strong>
        </div>
        <div class="span2">
        <strong>Stock Remaining</strong>
            </div>
        <div class="span2">
            <strong>Actions</strong>
        </div>
    </div>
        foreach (var item in Model)
        {
            @Html.Partial("ProductVariant", item);
        }
    }
</fieldset>

@Html.Pager(Model, "LowStockReport", i => new { page = i })