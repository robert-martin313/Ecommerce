@model dynamic
@{
    ViewBag.Title = "Import / Export Products";
}
<fieldset>
        <legend>Import / Export Products
        </legend>

        <div class="row">
             <span class="btn-group display-inline">
                 <a href="@Url.Action("ExportProducts", "ImportExport")" class="btn btn-primary">Export to Excel</a>
            </span>
            <div class="clearfix"></div>
                    
            @if (ViewBag.ExportStatus != null)
            {
                <br />
                <span class="alert alert-info">@ViewBag.ExportStatus</span>
                <div class="clearfix"></div>
            }
            <hr />
                  <div class="alert alert-info">Import File must be in .xslx format. After clicking on "Import Products" any new products inside file
                       will be added to database and existing ones will be updated with provided values in file.
                  </div>
            <div class="clearfix"></div>
                 @using (Html.BeginForm("ImportProducts", "ImportExport", FormMethod.Post, new {enctype = "multipart/form-data"}))
                 {
                     <label>Choose Import File</label>
                     <input type="file" name="document" id="document" />
                     <div class="clearfix"></div>
                     <br />
                     if (ViewBag.Messages != null)
                     {
                         foreach (var item in (Dictionary<string, List<string>>) ViewBag.Messages)
                         {
                             <span>
                                 <strong>@item.Key</strong> has the following errors:
                             </span>
                             <ul>
                                 @foreach (string error in (List<string>) item.Value)
                                 {
                                     <li>
                                         @error
                                     </li>
                                 }
                             </ul>
                         }
                         if (!((Dictionary<string, List<string>>) ViewBag.Messages).Any())
                         {
                             <div class="alert alert-success">
                                 All products and variants were successfully imported.
                             </div>
                         }
                     }
                     if (ViewBag.ImportStatus != null)
                     {
                         <div class="alert alert-warning">@ViewBag.ImportStatus</div>
                         <div class="clearfix"></div>
                     }

                     <input type="submit" class="btn btn-primary" value="Import"/>
                 }
        </div>
</fieldset>