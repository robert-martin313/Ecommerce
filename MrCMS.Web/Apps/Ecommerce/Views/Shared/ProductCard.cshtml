@using System.Drawing
@using MrCMS.Web.Apps.Ecommerce.Models
@using MrCMS.Web.Apps.Ecommerce.Settings
@model MrCMS.Web.Apps.Ecommerce.Pages.Product
@{ 
    var cart = ViewData["cart"] as CartModel;
    var buyableVariant = Model.Variants.Count == 1 ? Model.Variants.FirstOrDefault(variant => variant.CanBuy(cart, 1).OK) : null;
}
@if (Model.Variants.Any())
{
    <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 margin-bottom-30">
        <div class="product-con">
            <div class="product-image">
                <a href="/@Model.LiveUrlSegment">@RenderImage(Model.DisplayImageUrl, new Size { Width = 200, Height = 200 }, null, null, new { @class = "img-responsive" })</a>
                @*<img src="/Apps/Ecommerce/Content/Images/topoffer.png" class="offer" />*@
            </div>
            <div class="product-info">
                <div class="product-name">
                    <a href="/@Model.LiveUrlSegment">@Model.Name</a>
                </div>
                <div class="product-price">
                    <span class="current-price">
                        @(Model.IsMultiVariant ? "From " : "")
                        @Html.DisplayFor(product => product.DisplayPrice)
                    </span>
                    @if (Model.ShowPreviousPrice)
                    {
                        <span class="old-price">
                            <span class="inner">
                                @(SiteSettings<EcommerceSettings>().PreviousPriceText) : @Html.DisplayFor(product => product.DisplayPreviousPrice)
                            </span>
                        </span>
                    }
                </div>
            </div>
        </div>
    </div>


    @*<div class="span3 photo">
        
    </div>
    <div class="span6">
        <h4></h4>
        @(Model.Abstract != null ? (Model.Abstract.Length > 255 ? Model.Abstract.Substring(0, 250) + "..." : Model.Abstract) : String.Empty)
    </div>
    <div class="span3">
        <div class="text-right">
            <div class="product-price">
                
            </div>
            
            <div>
                <a href="/@Model.LiveUrlSegment" class="btn btn-more margin-bottom-5 span12">View</a>
            </div>
            @if (buyableVariant != null)
            {
                using (Html.BeginForm("AddToCart", "Cart", FormMethod.Post))
                {
                    <div class="row-fluid">
                        <button class="btn btn-info span12 margin-bottom-5">Add to basket</button>
                    </div>
                @Html.Hidden("ProductVariant.Id", buyableVariant.Id)
                @Html.Hidden("quantity", 1)
                }
                Html.RenderAction("Add", "Wishlist", new { id = buyableVariant.Id });
            }
        </div>
    </div>*@
}
