@using System.Drawing
@using MrCMS.Web.Apps.Ecommerce.Helpers
@model MrCMS.Web.Apps.Ecommerce.Pages.Product 
<div class="span2">
    <div class="product-picture text-align-center margin-top-10 padding-top-bottom-10">
        @if (Model.Images.Any())
        {
            <a href="/@Model.LiveUrlSegment" title="@Model.Name">@RenderImage(Model.Images.First().FileUrl, new Size{Width = 170,Height = 170}, alt:Model.Name)</a>
        }
    </div>
    <div class="product-brief">
        <div class="product-abstract">
            <h3><a href="/@Model.LiveUrlSegment">@Model.Name</a></h3>
            @Editable(Model, product => product.Abstract)
        </div>
        <div class="product-price">
            @Html.DisplayFor(product => product.DisplayPrice)
            @if (Model.DisplayPreviousPrice.HasValue && Model.ShowPreviousPrice)
            {
                <span>@Model.PreviousPriceText : @Model.DisplayPreviousPrice.ToCurrencyFormat()</span>
            }
            else
            {
                <span>&nbsp;</span>
            }
        </div>
        @if (!Model.IsMultiVariant && Model.Variants.FirstOrDefault().InStock)
    {
        using (Html.BeginForm("AddToCart", "Cart", FormMethod.Post))
        {
        @Html.Hidden("Id", Model.Variants.FirstOrDefault().Id)
        @Html.Hidden("quantity", 1)
        <button class="generic-button red-gradient span12" style="margin-left:0;">Add to basket</button>
        }
    }
    </div>
</div>